# Web开发倾向于ESM Node开发倾向于CJS
# 模块化的核心特性：
1. 拆分：将代码根据功能拆分为多个可复用模块
2. 加载：通过指定方式加载模块并执行与输出模块
3. 注入：将一个模块的输出注入到另一个模块
4. 管理：因为工程模块数量众多需管理模块间的依赖关系
# 作用：
1. 隔离作用域
2. 提供复用性
3. 提高可维护性
4. 解决命名冲突
5. 抽离公共代码
# CJS 与 ESM 
```text
-	    CJS	                     ESM
语法类型	动态	                     静态
关键声明	require	                 export与import
加载方式	运行时加载	             编译时加载
加载行为	同步加载	                 异步加载
书写位置	任何位置	                 顶层位置
指针指向	this指向当前模块	         this指向undefined
执行顺序	首次引用时加载模块          引用时生成只读引用
        再次引用时读取缓存	         执行时才是正式取值                                 
属性引用	基本类型属于复制不共享      所有类型属于动态只读引用
        引用类型属于浅拷贝且共享	
属性改动	工作空间可修改引用的值	     工作空间不可修改引用的值
                                 但可通过引用的方法修改
```
* 运行时加载指整体加载模块生成一个对象，再从对象中获取所需的属性方法去加载。最大特性是全部加载，只有运行时才能得到该对象，无法在编译时做静态优化
* 编译时加载指直接从模块中获取所需的属性方法去加载。最大特性是按需加载，在编译时就完成模块加载，效率比其他方案高，无法引用模块本身(本身不是对象)，但可拓展JS高级语法(宏与类型校验)
# Node中判断解析 CJS/ESM
* mjs文件使用ESM解析，cjs文件使用CJS解析，js文件使用基于package.json指定的type解析(type=commonjs使用CJS，type=module使用ESM)
* 以下情况视为ESM
```text
 文件后缀为.mjs
 文件后缀为.js且在package.json中指定type为module
 命令中加上--input-type=module
 命令中加上--eval cmd
```
